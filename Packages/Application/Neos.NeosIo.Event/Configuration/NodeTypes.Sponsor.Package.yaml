###########################################
# Node type for a sponsor package
###########################################

'Neos.NeosIo.Event:Sponsor.Package':
  superTypes:
    'TYPO3.Neos.NodeTypes:Page': true
  constraints:
    nodeTypes:
      'TYPO3.Neos.NodeTypes:Page': false
      'Neos.NeosIo.Event:Event': false
  ui:
    label: 'Sponsor Package'
    icon: 'icon-credit-card'
    group: 'event'
    inspector:
      groups:
        'package':
          label: 'Sponsor package properties'
  properties:
    'freeTickets':
      type: 'integer'
      defaultValue: '1'
      ui:
        label: 'Free tickets included'
        inlineEditable: true
        inspector:
          group: 'package'
          position: 15
    'packageLimit':
      type: 'integer'
      defaultValue: '1'
      ui:
        label: 'Package Limit'
        inlineEditable: true
        inspector:
          group: 'package'
          position: 16
    'packagesAvailable':
      type: 'integer'
      defaultValue: '1'
      ui:
        label: 'Packages available'
        inlineEditable: true
        inspector:
          group: 'package'
          position: 17
    'costs':
      type: string
      ui:
        label: 'Costs (vat excl.)'
        inlineEditable: true
        inspector:
          group: 'package'
          position: 20
    'logoFixed':
      type: boolean
      ui:
        label: 'Logo on website (permanent)'
        inspector:
          group: 'package'
          position: 25
      # Use the logoFixed field to add offers to camps
      search:
        fulltextExtractor: ${Indexing.extractInto('h2', Array.join(q(node).children('[instanceof Neos.NeosIo.Event:Sponsor.Partner]').mapProperty('title'), ', '))}
    'logoVariable':
      type: boolean
      ui:
        label: 'Logo on website (variable)'
        inspector:
          group: 'package'
          position: 30
    'opportunities':
      type: references
      ui:
        label: 'Opportunities of this package'
        reloadIfChanged: true
        inspector:
          group: 'package'
          position: 50
          editorOptions:
            nodeTypes: ['Neos.NeosIo.Event:Sponsor.Opportunity']